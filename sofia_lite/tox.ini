[tox]
envlist = py, e2e
isolated_build = True

[testenv]
deps =
    pytest>=7.0.0
    pytest-asyncio>=0.21.0
    pytest-mock>=3.10.0
    httpx>=0.24.0
    twilio>=9.0
    python-dotenv>=1.0.0
commands =
    pytest -v {posargs:tests/}

[testenv:e2e]
setenv =
    TEST_MODE = true
    OPENAI_API_KEY = sk-test
    TWILIO_ACCOUNT_SID = AC_test
    TWILIO_AUTH_TOKEN = tok_test
    GOOGLE_APPLICATION_CREDENTIALS = /dev/null
    GOOGLE_PROJECT_ID = test-sofia
    FIRESTORE_EMULATOR_HOST = localhost:8080
deps =
    {[testenv]deps}
    google-cloud-firestore>=2.0.0
commands =
    scripts/start_emulators.sh
    pytest -v -m "e2e" {posargs:tests/} 